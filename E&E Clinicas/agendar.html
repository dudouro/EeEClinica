<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>E&E Clínicas</title>
    <meta name="description"
        content="E&E Clínicas, fundada pelos médicos Eduardo Oliveira e Matheus Eduardo, oferece atendimento especializado e humanizado em Uberlândia.">
    <link rel="stylesheet" href="css/style.css">
    meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>

<body>
    <header>
        <img src="images/logonome.png" alt="Logo da E&E Clínicas" class="logo" width="200" height="100%">
    </header>
    <nav>
        <ul>
            </li>
            <li><a href="index.html">Home</a></li>
            <li><a href="galeria.html">Galeria</a></li>
            <li><a href="contato.html">Contato</a></li>
            <li><a href="login.html">Login</a></li>
        </ul>
    </nav>
    <main>
        <div>

            <h2>Agende uma Consulta</h2>
            <p>Preencha o formulário abaixo para agendar sua consulta. Na E&E Clínicas, priorizamos a sua saúde e
                bem-estar em cada atendimento.</p>

            <form action="/agendar" method="POST">
                <div class="row">
                    <div class="col-sm-9">
                        <label for="cpfPaciente" class="form-label">CPF:</label>
                        <input type="text" id="cpfPaciente" class="form-control" name="cpfPaciente" maxlength="11"
                            placeholder="Digite seu CPF" required>
                    </div>
                    <div class="col-sm-3">
                        <label for="data" class="form-label">Data e Hora:</label>
                        <input type="datetime-local" id="data" class="form-control" name="data" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <label for="sintomas" class="form-label">Sintomas:</label>
                        <textarea id="sintomas" class="form-control" name="sintomas" rows="5"
                            placeholder="Descreva seus sintomas" required></textarea>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-8">
                        <label for="crmMedico" class="form-label">CRM do Médico:</label>
                        <input type="text" id="crmMedico" class="form-control" name="crmMedico"
                            placeholder="CRM do médico responsável" required>
                    </div>
                    <div class="col-md-4">
                        <label for="especialidade" class="form-label">Especialidade:</label>
                        <select id="especialidade" class="form-select" name="especialidade" required>
                            <option value="" disabled selected>Selecione uma especialidade</option>
                            <option value="clinicoGeral">Clínico Geral</option>
                            <option value="cardiologia">Cardiologia</option>
                            <option value="dermatologia">Dermatologia</option>
                            <option value="pediatria">Pediatria</option>
                            <option value="ortopedia">Ortopedia</option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-8">
                        <button type="button" id="butao" class="btn btn-primary">Enviar</button>
                    </div>
                </div>
            </form>
        </div>
        <script>
            document.getElementById("butao").addEventListener("click", function () {
                // Captura os valores dos campos do formulário
                const cpfPaciente = document.getElementById("cpfPaciente").value;
                const data = document.getElementById("data").value;
                const sintomas = document.getElementById("sintomas").value;
                const crmMedico = document.getElementById("crmMedico").value;
                const especialidade = document.getElementById("especialidade").value;

                // Limpa mensagens anteriores
                document.getElementById("mensagem").innerText = "";
                document.getElementById("erro").innerText = "";

                // Validação simples
                if (!cpfPaciente || !data || !sintomas || !crmMedico || !especialidade) {
                    document.getElementById("erro").innerText = "Por favor, preencha todos os campos!";
                    return;
                }

                // Cria o objeto JSON com os dados do formulário
                const agendamento = {
                    cpfPaciente: cpfPaciente,
                    data: data,
                    sintomas: sintomas,
                    crmMedico: crmMedico,
                    especialidade: especialidade
                };
                // Envia os dados para a API FastAPI usando Fetch API
                fetch("http://localhost:8000/agendar", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify(agendamento), // Converte o objeto JS para JSON
                })
                    .then(response => response.json()) // Trata a resposta da API
                    .then(data => {
                        // Exibe uma mensagem de sucesso ou de erro
                        if (data.success) {
                            document.getElementById("mensagem").innerText = "Agendamento realizado com sucesso!";
                        } else {
                            document.getElementById("erro").innerText = "Erro ao realizar o agendamento. Tente novamente.";
                        }
                    })
                    .catch((error) => {
                        console.error("Erro:", error);
                        document.getElementById("erro").innerText = "Erro ao conectar com o servidor.";
                    });
            });
        </script>

    </main>


    <footer>
        <address>Av. Principal, 123, Bairro Centro, Uberlândia - MG</address>
        <p>Contato: (34) 1234-5678 | Email: contato@eeclinicas.com.br</p>
    </footer>
</body>

</html>